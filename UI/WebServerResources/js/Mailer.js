!function(){"use strict";function a(a,k){a.state("mail",{url:"/Mail",views:{mailboxes:{templateUrl:"UIxMailMainFrame",controller:"MailboxesController",controllerAs:"app"}},resolve:{stateAccounts:b}}).state("mail.account",{url:"/:accountId","abstract":!0,views:{mailbox:{template:"<ui-view/>"}},resolve:{stateAccount:c}}).state("mail.account.virtualMailbox",{url:"/virtual",views:{"mailbox@mail":{templateUrl:"UIxMailFolderTemplate",controller:"MailboxController",controllerAs:"mailbox"}},resolve:{stateMailbox:f}}).state("mail.account.virtualMailbox.message",{url:"/:mailboxId/:messageId",views:{message:{templateUrl:"UIxMailViewTemplate",controller:"MessageController",controllerAs:"viewer"}},resolve:{stateMailbox:g,stateMessages:e,stateMessage:h}}).state("mail.account.mailbox",{url:"/:mailboxId",views:{"mailbox@mail":{templateUrl:"UIxMailFolderTemplate",controller:"MailboxController",controllerAs:"mailbox"}},resolve:{stateMailbox:d,stateMessages:e}}).state("mail.account.mailbox.message",{url:"/:messageId",views:{message:{templateUrl:"UIxMailViewTemplate",controller:"MessageController",controllerAs:"viewer"}},onEnter:i,onExit:j,resolve:{stateMessage:h}}),k.otherwise("/Mail")}function b(a,b){var c=b.$findAll(mailAccounts),d=[];return angular.forEach(c,function(a,b){var c=a.$getMailboxes();d.push(c.then(function(b){return a}))}),a.all(d)}function c(a,b){return _.find(b,function(b){return b.id==a.accountId})}function d(a,b,c,d){var e,f=c(a.mailboxId);return e=function(a){var b=_.find(a,function(a){return a.path==f});return b||angular.forEach(a,function(a){!b&&a.children&&a.children.length>0&&(b=e(a.children))}),b},d.selectedFolder&&(d.selectedFolder.$isLoading=!0),e(b.$mailboxes)}function e(a,b){return a.$virtualMode?[]:b.$filter()}function f(a,b){return b.$virtualMode?b.selectedFolder:a.reject("No virtual mailbox defined")}function g(a,b,c,d){var e=c(d.mailboxId);return b.$virtualMode?(b.selectedFolder.resetSelectedMessage(),_.find(b.selectedFolder.$mailboxes,function(a){return a.path==e})):a.reject("No virtual mailbox defined for message")}function h(a,b,c,d,e,f){var g;return(g=_.find(e.$messages,function(a){return a.uid==parseInt(c.messageId)}))?g.$reload():void d.go("mail.account.mailbox",{accountId:e.$account.id,mailboxId:b(e.path)})}function i(a,b){b.selectedMessage=parseInt(a.messageId)}function j(a){a.selectedMessage=-1}function k(a,b,c){a.$on("$stateChangeError",function(a,d,e,f,g,h){b.error(h),c.go("mail")}),a.$on("$routeChangeError",function(a,c,d,e){b.error(a,c,d,e)})}angular.module("SOGo.MailerUI",["ui.router","ck","angularFileUpload","SOGo.Common","SOGo.ContactsUI","ngAnimate","SOGo.PreferencesUI"]).config(a).run(k),a.$inject=["$stateProvider","$urlRouterProvider"],b.$inject=["$q","Account"],c.$inject=["$stateParams","stateAccounts"],d.$inject=["$stateParams","stateAccount","decodeUriFilter","Mailbox"],e.$inject=["Mailbox","stateMailbox"],f.$inject=["$q","Mailbox"],g.$inject=["$q","Mailbox","decodeUriFilter","$stateParams"],h.$inject=["Mailbox","encodeUriFilter","$stateParams","$state","stateMailbox","stateMessages"],i.$inject=["$stateParams","stateMailbox"],j.$inject=["stateMailbox"],k.$inject=["$rootScope","$log","$state"]}();
//# sourceMappingURL=Mailer.js.map